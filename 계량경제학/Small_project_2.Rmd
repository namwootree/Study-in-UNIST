---
title: "Econometrics Small Project 2"
author: "Namwoo Kwon (20236002)"
date: "2023-04-24"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

## Description
* The goal of Small Projects is “learning by doing” rather than evaluating your knowledge.
* So, this project will be graded based on your efforts rather than correctness. 
* In other words, you will receive a full score if you answer all questions enough.

<br>

## Instructions
* Use R to estimate the model and answer the questions. * Please work on the problem set and submit it in a PDF format along with your R script file via Blackboard Assignments by the end of April 27th (Thursday).
* Please do not zip the file!

<br>

# Small Project 2

<br>

## 1. Use the data in ATTEND for this exercise. 

<br>

#### 1-1 Intro 
* attend : classes attended out of 32
* termGPA : GPA for term 
* priGPA : cumulative GP A prior to term 
* ACT : ACT score 
* final:final exam score 
* atndrte : percent classes attended
* hwrte : percent homework turned in 
* frosh : =1 if freshman 
* soph : =1 if sophomore
* missed : number of classes missed 
* stndfnl : (final-mean)/sd

<br>

```{r 0-1}
library(wooldridge)

data(attend, package='wooldridge')
```
```{r 0-2}
head(attend)
str(attend)
```

<br>

#### 1-2. Obtain the minimum, maximum, and average values for the variables atndrte, priGPA, and ACT. 

<br>

```{r 1-1}
attend.feature.selectd <- attend[c('atndrte', 'priGPA', 'ACT')]
summary(attend.feature.selectd)[c(1,4,6),]
```
<br>

#### 1-3. Estimate the model. And, write the results in equation form. Interpret the intercept. Does it have a useful meaning? 

<br>

$$
atndrte = \beta_{0} + \beta_{1}priGPA + \beta_{2}ACT + \mu
$$
<br>

##### Answer
* First of all, looking at the F-statistic of the model, it can be seen that the two variables (priGPA & ACT) are significant.<br><br>
* And, looking at Intercept, it can be confirmed that the class attendance rate is estimated to be about 75% even if the values of priGPA and ACT are 0.
  - In fact, there are students who participate in classes only to the extent that they are not expelled and submit the exam in blank
  - But this is not the usual situation. Therefore, I think the value of intercept is not useful.
  - And I think the value will be greatly different if other variables are additionally applied to the model.

<br>

```{r 2-1}
regression <- lm(atndrte ~ priGPA+ACT, data=attend.feature.selectd)
summary(regression)
```
```{r 2-2}
library(scatterplot3d)

s3d <- scatterplot3d(attend.feature.selectd$priGPA,
                     attend.feature.selectd$ACT,
                     attend.feature.selectd$atndrte,
                     angle=50,
                     pch=19,
                     color='red',
                     main='The fitted model in depend on Samples',
                     xlab='Cumulative GPA prior to term',
                     ylab='ACT score',
                     zlab='Percent Classes Attended'
                     )

s3d$plane3d(regression$coefficients,
            lty=3,
            col='darkblue')
```
```{r 2-3}
regression$coefficients[1]
```
<br>

#### 1-4. Discuss the estimated slope coefficients. Are there any surprises? 

<br>

##### Answer
* Looking at the Estimate and t-value of the two variables, the following contents can be confirmed.
  - Through the t-value, it can be confirmed that both variables are significant.
  - However, contrary to our common sense (Students who get good grades will have a high attendance rate), the model estimates the coefficient of ACT to be negative.
  - This may be the result of insufficient selection of meaningful variables belonging to 'error'.
  - In fact, if you look at R-squared, you can see that it is not that high at 0.2906.<br><br>
```{r 3-1}
regression$coefficients[c(2,3)]
```
<br>

#### 1-5. What is the predicted atndrte if priGPA = 3.65 and ACT = 20? What do you make of this result? Are there any students in the sample with these values of the explanatory variables? 

<br>
$$
\hat{atndrte}=75.70 + 17.261(3.65)-1.171(20)
$$
<br>

##### Answer
* If the priGPA is 3.65 and the ACT is 20, the class attendance rate is about 104.37%.
* However, class attendance cannot exceed 100%.
* This means that students with a preGPA of 3.65 and an ACT of 20 got relatively good test scores. 
* Because there are many students who have similar attendance rate but relatively low scores (This means that the preGPA is low by the coefficient of the model).
* If you check the sample for a student who actually has a priGPA of 3.65 and an ACT of 20, the atndrte is 87.5.
* When looking at only students with attendance rates of 82.5 to 92.5, it can be confirmed that the student's priGPA is higher than the third quartile.

<br>

```{r 4-1}
priGPA <- 3.65
ACT <- 20
new.data <- data.frame(priGPA, ACT)

Predicted.Result <- predict(regression,
                            newdata=new.data)
print(Predicted.Result)
```
```{r 4-2}
subset(attend.feature.selectd, 
       priGPA>=3.65&ACT==20)
```
```{r 4-3}
summary(subset(attend.feature.selectd, 
       atndrte>=82.500&atndrte<=92.500))
```
<br>

#### 1-6.  If Student A has priGPA = 3.1 and ACT = 21 and Student B has priGPA = 2.1 and ACT = 26, what is the predicted difference in their attendance rates? 

<br>

$$
\hat{atndrte_{A}}=75.70 + 17.261(3.1)-1.171(21)
$$
$$
\hat{atndrte_{B}}=75.70 + 17.261(2.1)-1.171(26)
$$

<br>

##### Answer
* Student A's expected attendance is about 93.16% and Student B's expected attendance is about 67.32%.
* The difference in attendance between the two is about 25.843 per cent.
* The reason for this big difference is that preGPA with positive coefficients is larger for student A and ACT with negative coefficients is larger for student B.


<br>

```{r 5-1}
priGPA <- c(3.1, 2.1)
ACT <- c(21, 26)

new.data <- data.frame(priGPA, ACT)

Predicted.Result <- predict(regression,
                            newdata=new.data)

print(Predicted.Result)
print(Predicted.Result[1]-Predicted.Result[2])
```

<br>

## 2. Use the data in MEAP93 to answer this question. 

<br>

#### 2-1 Intro 
* lnchprg : perc of studs in sch lnch prog 
* enroll : school enrollment 
* staff : staff per 1000 students 
* expend : expend. per stud, $ 
* salary : avg. teacher salary, $ 
* benefits : avg. teacher benefits, $ 
* droprate : school dropout rate, perc 
* gradrate : school graduation rate, perc 
* math10 : perc studs passing MEAP math 
* sci11 : perc studs passing MEAP science 
* totcomp : salary + benefits 
* ltotcomp : log(totcomp) 
* lexpend : log of expend 
* lenroll : log(enroll) 
* lstaff : log(staff) 
* bensal : benefits/salary 
* lsalary : log(salary)

<br>

```{r 6-1}
library(wooldridge)

data(meap93, package='wooldridge')
```
```{r 6-2}
head(meap93)
str(meap93)
```

<br>

#### 2-1.  Estimate the model. And report the results in the usual form, including the sample size and R-squared. Are the signs of the slope coefficients what you expected? Explain. 

<br>

$$
math10 = \beta_{0}+\beta_{1}log(expend)+\beta_{2}lnchprg+\mu
$$

<br>

##### Answer
* First of all, looking at the F-statistic of the model, it can be seen that the two variables (lexpend & lnchprg) are significant.
* However, it should be noted that Intercept did not show significant t-value.
* And R-squared is not that high.
* Anyway, common sense suggests that the more money you spend on education, the better test scores will be.
* And in general, I think the richer the family, the more money they spend on education.
* Therefore, the larger the ratio spent on students and the smaller the participation rate in the school lunch cost support program, the higher the rate of passing the math test.
* Looking at the coefficients of the model that learned sample data, as expected, lexpend has a positive coefficient and lnchprg has a negative coefficient.

<br>

```{r 7-1}
meap93.feature.selectd <- meap93[c('math10', 'lexpend', 'lnchprg')]
```
```{r 7-2}
regression <- lm(math10 ~ lexpend+lnchprg, data=meap93.feature.selectd)
summary(regression)
```
```{r 7-3}
s3d <- scatterplot3d(meap93.feature.selectd$lexpend,
                     meap93.feature.selectd$lnchprg,
                     meap93.feature.selectd$math10,
                     angle=50,
                     pch=19,
                     color='red',
                     main='The fitted model in depend on Samples',
                     xlab='Log of Expend per Students, $',
                     ylab='Percent of Students in School Lunch Program',
                     zlab='Percent Students passing MEAP math'
                     )

s3d$plane3d(regression$coefficients,
            lty=3,
            col='darkblue')
```

<br>

#### 2-2. What do you make of the intercept you estimated in part (i)? In particular, does it make sense to set the two explanatory variables to zero? [Hint: Recall that log(1) = 0.] 

<br>

##### Answer
* If Intercept does not increase the percentage spent on students to a certain level because it has a negative value, no one will pass the math test.
* This is a result that deviates from common sense. This is because tests in public education cannot require more than a certain level of private education expenditure. 
* A zero LNCHPRG means that there are no students from poor families (I guess the school is located in a rich neighborhood), and how much you spend on students is exactly what affects test pass rates.
* However, the fact that the log of expend is 0 shows the same result as the case where expend is 1.
* In other words, zero lexpend variable means that spending $1 per student has no effect on passing the math test.
* Spending a dollar per student can be a pointless expense. One dollar is the amount a student has to buy only one ball pan or an eraser. 
* One more of these is unlikely to result in significant changes in math test scores

<br>

```{r 8-1}
expend <- 1
log10(expend)
```
```{r 8-2}
list.expend <- c(-0.2, 0.0, 0.2, 0.4, 0.6, 0.8, 1.0, 1.2)
list.log10.expend <- c(log10(-0.2), log10(0.0), log10(0.2), log10(0.4),
                       log10(0.6), log10(0.8), log10(1.0), log10(1.2))

plot(list.expend,
     list.log10.expend,
     type='b',
     main='Log_10(Expend)',
     xlab='expend',
     ylab='lexpend')
abline(h=0, col='red')
```

<br>

#### 2-3. Now run the simple regression of math10 on log(expend), and compare the slope coefficient with the estimate obtained in part (i). Is the estimated spending effect now larger or smaller than in part (i)? 

<br>

$$
math10 = -69.341+11.164  \ log(expend)
$$

<br>

##### Answer
* The slope coefficient of the lexend variable increased from 6.22969 to 11.164.
* This means that the importance of lexpand as a variable affecting test results has increased.
* However, R-squared was significantly lowered from 0.1799 to 0.02966.
* In other words, the explanatory power of math10 is weaker than that of the existing model.

<br>

```{r 9-1}
regression <- lm(math10 ~ lexpend, data=meap93.feature.selectd)

summary(regression)
```
```{r 9-2}
plot(meap93.feature.selectd$lexpend,
     meap93.feature.selectd$math10,
     main='Regression',
     xlab='lexpend',
     ylab='math10',
     pch=3)

abline(lm(math10 ~ lexpend, data=meap93.feature.selectd), col='red')
```

<br>

#### 2-4. Find the correlation between lexpend = log(expend) and lnchprg. Does its sign make sense to you? 

<br>

##### Answer
* The two variables, lxpend and lnchprg, have a negative correlation. (-0.1927042)
* This is because the high amount spent per student is likely to be students from wealthy families, making it less likely to apply for a school lunch support program.

<br>

```{r 10-1}
cor(meap93.feature.selectd$lexpend,
     meap93.feature.selectd$lnchprg)
```
```{r 10-2}
plot(meap93.feature.selectd$lexpend,
     meap93.feature.selectd$lnchprg,
     main='Scatter Plot',
     xlab='lexpend',
     ylab='lnchprg',
     pch=16,
     col='skyblue')

abline(lm(lnchprg ~ lexpend,
          data = meap93.feature.selectd), 
       col = "red",
       lty = 1)
```
<br>

#### 2-5. Use part (iv) to explain your findings in part (iii).

<br>

$$
math10 = -20.36075 \ +6.22969 \ log(expend) - 0.30459 \ lnchprg
$$
$$
math10 = -69.341+11.164  \ log(expend)
$$
$$
corr(lexpend, lnchprg) = - 0.1927042
$$

<br>

##### Answer
* There is a negative correlation between the two variables, and lnchprg decreases math10 while lexpend increases math10.
* When lnchprg is included in the error, the smaller lnchprg is, the higher math10 is, so the slope coefficient of lexpend must be as large as the effect of lnchprg on math10.
